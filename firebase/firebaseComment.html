<!DOCTYPE html>
<html>
<head>
	<title>fire test</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

	<script src="https://www.gstatic.com/firebasejs/5.7.1/firebase.js"></script>
	<script>
	  // Initialize Firebase
	  var config = {
	    apiKey: "AIzaSyCxepxkzpJ4sysUS2LjZhtZ52MaqwWVkd4",
	    authDomain: "testproject-52455.firebaseapp.com",
	    databaseURL: "https://testproject-52455.firebaseio.com",
	    projectId: "testproject-52455",
	    storageBucket: "testproject-52455.appspot.com",
	    messagingSenderId: "793011152738"
	  };
	  firebase.initializeApp(config);

	  //create new database reference "test"
	  var commentsRef = firebase.database().ref('comments/');

	  //write comments record to database
	  function writeData(name, email, comment) {
	  	commentsRef.push(
		  	{
		  		name:name,
		  		email:email,
		  		comment:comment
		  	}
	  	)
	  }

	  //get values and write to database
	  window.addEventListener("load", function() { //execute after html loading finished, to get following elements' value
	  	//console.log("page loaded in DOM")
	  	function addComment(){
	  		var name = document.getElementById('nameID').value
	  		var email = document.getElementById('emailID').value
	  		var comment = document.getElementById('commentID').value
	  		writeData(name, email, comment)
	  	}

	  	//add click event listener
	  	document.getElementById("buttonID").addEventListener('click',addComment)

	  	//add comment element 
		function addCommentElement(name, comment) {
			//get comments list element
			var ele = document.getElementById("comments")
			ele.innerHTML += '<li class="list-group-item"><small>'+name+': </small>'+comment+'</li>'
		}

		//excute for every existing child, and every time a new child added in database
	  	commentsRef.on('child_added', function (data) {
	  		addCommentElement(data.val().name, data.val().comment)
	  	})
	  }
	  )
	</script>

	<!--OAuth test-->
	<meta name="google-signin-client_id" content="802438001010-m1k5ms9adurv18itea8l31fbp0jig4mu.apps.googleusercontent.com">
	<script src="https://apis.google.com/js/platform.js" async defer></script>

</head>
<body>
	<!--OAuth test-->
	<div class="g-signin2" data-onsuccess="onSignIn"></div>

	<div class="container">
		<div class="row">
			<form class="form-horizontal">
				<div class="form-group">
					<label for="nameID">Name:</label>
					<input class="form-control" type="text" name="name" id="nameID" placeholder="input your name">
				</div>
				<div class="form-group">
					<label for="emailID">Email:</label>
					<input class="form-control" type="text" name="email" id="emailID" placeholder="input your email">
				</div>
				<div class="form-group">
					<textarea id="commentID" name="comment" class="form-control"></textarea>
				</div>
				<button type="button" id="buttonID" class="btn btn-danger">submit</button>
			</form>
		</div>
		<div class="row">
			<ul class="list-group list-group-flush" id="comments">
			</ul>
		</div>
		<a href="../index.html">back</a>
	</div>
</body>
</html>